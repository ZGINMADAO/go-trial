<!DOCTYPE html>
<html>


<!-- Mirrored from www.zi-han.net/theme/hplus/table_basic.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 20 Jan 2016 14:20:01 GMT -->
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title>H+ 后台主题UI框架 - 基础表格</title>
    <meta name="keywords" content="H+后台主题,后台bootstrap框架,会员中心主题,后台HTML,响应式后台">
    <meta name="description" content="H+是一个完全响应式，基于Bootstrap3最新版本开发的扁平化主题，她采用了主流的左右两栏式布局，使用了Html5+CSS3等现代技术">

    <link rel="shortcut icon" href="favicon.ico">
    <link href="/public/css/bootstrap.min14ed.css?v=3.3.6" rel="stylesheet">
    <link href="/public/css/font-awesome.min93e3.css?v=4.4.0" rel="stylesheet">
    <link href="/public/css/plugins/iCheck/custom.css" rel="stylesheet">
    <link href="/public/css/animate.min.css" rel="stylesheet">
    <link href="/public/css/style.min862f.css?v=4.1.0" rel="stylesheet">

</head>

<body class="gray-bg">
<div class="wrapper wrapper-content animated fadeInRight">

    <div class="row">
        <div class="col-sm-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5></h5>
                    <div class="ibox-tools">
                        <a class="collapse-link">
                            <i class="fa fa-chevron-up"></i>
                        </a>
                        <a class="dropdown-toggle" data-toggle="dropdown" href="table_basic.html#">
                            <i class="fa fa-wrench"></i>
                        </a>
                        <ul class="dropdown-menu dropdown-user">
                            <li><a href="table_basic.html#">选项1</a>
                            </li>
                            <li><a href="table_basic.html#">选项2</a>
                            </li>
                        </ul>
                        <a class="close-link">
                            <i class="fa fa-times"></i>
                        </a>
                    </div>
                </div>
                <div class="ibox-content">
                    <form class="row">
                    {{/*<div class="col-sm-5 m-b-xs">*/}}
                    {{/*<select class="input-sm form-control input-s-sm inline">*/}}
                    {{/*<option value="0">请选择</option>*/}}
                    {{/*<option value="1">选项1</option>*/}}
                    {{/*<option value="2">选项2</option>*/}}
                    {{/*<option value="3">选项3</option>*/}}
                    {{/*</select>*/}}
                    {{/*</div>*/}}
                    {{/*<div class="col-sm-4 m-b-xs">*/}}
                    {{/*<div data-toggle="buttons" class="btn-group">*/}}
                    {{/*<label class="btn btn-sm btn-white">*/}}
                    {{/*<input type="radio" id="option1" name="options">天</label>*/}}
                    {{/*<label class="btn btn-sm btn-white active">*/}}
                    {{/*<input type="radio" id="option2" name="options">周</label>*/}}
                    {{/*<label class="btn btn-sm btn-white">*/}}
                    {{/*<input type="radio" id="option3" name="options">月</label>*/}}
                    {{/*</div>*/}}
                    {{/*</div>*/}}
                        <div class="col-sm-3">
                            <div class="input-group">
                                <input type="text" placeholder="请输入关键词" class="input-sm form-control" name="keyWord"
                                       id="keyWord">
                                <span
                                        class="input-group-btn">
                                        <button type="button" class="btn btn-sm btn-primary"
                                                onclick="refresh()"> 搜索</button> </span>
                            </div>
                        </div>

                        <div class="col-sm-2 pull-right" style="text-align: right">
                            <button type="button" class="btn btn-md btn-primary" id="addBtn"> 添加</button>
                        </div>
                    </form>
                    <div class="table-responsive">

                        <table id="table" class="table table-striped" data-mobile-responsive="true"></table>

                    </div>

                </div>
            </div>
        </div>

    </div>
</div>


<script src="/public/js/jquery.min.js?v=2.1.4"></script>
<script src="/public/js/bootstrap.min.js?v=3.3.6"></script>
<script src="/public/js/content.min.js?v=1.0.0"></script>


<script src="/public/js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
<script src="/public/js/plugins/bootstrap-table/bootstrap-table-mobile.min.js"></script>
<script src="/public/js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>

<script src="/public/js/plugins/layer-v3.1.1/layer/layer.js"></script>
<script src="/public/js/plugins/iCheck/icheck.min.js"></script>

<script>
    $(document).ready(function () {
        $(".i-checks").iCheck({checkboxClass: "icheckbox_square-green", radioClass: "iradio_square-green"})
    });

    var bootstrap_table_ajax_url = '/admin/product/type/list';

    $('#table').bootstrapTable({
        classes: 'table table-hover', //bootstrap的表格样式
        sidePagination: 'server', //获取数据方式【从服务器获取数据】
        url: bootstrap_table_ajax_url,//ajax链接
        pagination: true, //分页
        pageNumber: 1, //页码【第X页】
        pageSize: 10, //每页显示多少条数据
        sortName: 'id', //排序字段
        sortOrder: 'DESC',//排序方式
        queryParamsType: '', // limit
        striped: true,
        queryParams: function (params) {
            params.page = params.pageNumber;
            params.size = params.pageSize;
            $.extend(params, {keyWord: $("#keyWord").val()});
            return params;
        },

        columns: [ //字段

            {title: '序号', field: 'Id', align: 'center', valign: 'middle'},
            {title: '名称', field: 'Title', align: 'center', valign: 'middle'},
            {title: '图片', field: 'Image', align: 'center', valign: 'middle'},
            {title: '创建时间', field: 'CreatedAt', align: 'center', valign: 'middle'},
            {
                title: '操作', field: 'Id', align: 'center', valign: 'middle',
                formatter: function (value) {
                    return (
                            '<a href="javascript: void(0);" onclick="units.modify(this,' + value + ')">修改</a>'
                    );
                }
            }
        ]

    });

    function refresh() {
        $('#table').bootstrapTable('refresh');
    }


    var layerIndex;
    $(document).on('click', '#addBtn', function () {

        layerIndex = layer.open({
            type: 1,
            title: '添加商品种类',
            area: ['40%', '30%'],
            content: units.buildHtml()
        });
    });

    function getFormObj(formId) {
        var data = {};
        var formVal = $(formId).serializeArray();
        var temp = {};
        $.each(formVal, function (inx, val) {
            temp[val.name] = val.value;
            $.extend(data, temp);
        });
        return data;
    }

    $(document).on('click', '#addYes', function () {
        var id = $(this).data('id');


        var type, url;
        if (id) { //修改
            type = 'put';
            url = '/admin/product/type/' + id;
        } else {
            type = 'post';
            url = '/admin/product/type';
        }

        $.ajax({
            type: type,
            url: url,
            data: getFormObj("#addForm"),
            success: function (result) {
                if (result.status === true) {
                    layer.close(layerIndex);
                    layer.msg(result.message, {icon: 6, time: 3000});
                    refresh();
                } else {
                    layer.alert(result.message, {icon: 5});
                }
            },
            error: function () {
                layer.alert('异步请求失败');
            }
        });
    });

    var units = {

        buildHtml: function (title, image) {
            if (title === undefined) {
                title = '';
            }
            if (image === undefined) {
                image = '';
            }
            return '<div class="ibox float-e-margins" style="height: 100px">' +
                    '        <div class="ibox-content">' +
                    '            <form class="form-horizontal" id="addForm">' +
                    '                <div class="form-group">' +
                    '                    <label class="col-sm-3 control-label">名称：</label>' +
                    '                    <div class="col-sm-8">' +
                    '                        <input type="text" placeholder="请输入名称" class="form-control" name="title" value="' + title + '">' +
                    '                    </div>' +
                    '                </div>' +
                    '                <div class="form-group">' +
                    '                    <label class="col-sm-3 control-label">图片：</label>' +
                    '                    <div class="col-sm-8">' +
                    '                        <input type="text" placeholder="请输入图片" class="form-control" name="image" value="' + image + '">' +
                    '                    </div>' +
                    '                </div>' +
                    '                <div class="form-group">' +
                    '                    <div class="col-sm-offset-3 col-sm-8">' +
                    '                        <button class="btn btn-md btn-success" type="button" id="addYes" data-id="">确定</button>' +
                    '                    </div>' +
                    '                </div>' +
                    '            </form>' +
                    '        </div>' +
                    '    </div>';
        },
        modify: function (_this, id) {
            var temp = $(_this).parent().prev();
            layerIndex = layer.open({
                type: 1,
                title: '修改商品种类',
                area: ['40%', '30%'],
                content: units.buildHtml(temp.prev().prev().text(), temp.prev().text()),
                success: function () {
                    $("#addYes").data('id', id);
                }
            });
        }
    };
</script>
<script type="text/javascript" src="http://tajs.qq.com/stats?sId=9051096" charset="UTF-8"></script>
</body>


<!-- Mirrored from www.zi-han.net/theme/hplus/table_basic.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 20 Jan 2016 14:20:01 GMT -->
</html>
